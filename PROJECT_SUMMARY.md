# Kiro API Client - é¡¹ç›®æ€»ç»“

## ğŸ‰ é¡¹ç›®å®ŒæˆçŠ¶æ€

**çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ  
**å®Œæˆæ—¶é—´**: 2024-02-04  
**æµ‹è¯•è¦†ç›–**: 17/17 æµ‹è¯•é€šè¿‡  

---

## ğŸ“¦ é¡¹ç›®æ¦‚è§ˆ

Kiro API Client æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Go è¯­è¨€å®¢æˆ·ç«¯åº“ï¼Œç”¨äºä¸ Kiro IDE çš„åç«¯ API è¿›è¡Œäº¤äº’ã€‚é¡¹ç›®åŒ…å«å®Œæ•´çš„ Token ç®¡ç†ã€MCP åè®®æ”¯æŒã€Web Search åŠŸèƒ½ã€Chat åŠŸèƒ½ï¼Œä»¥åŠä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ HTTP API ä»£ç†æœåŠ¡å™¨å’Œ Web UIã€‚

### æ ¸å¿ƒç‰¹æ€§

1. **Token ç®¡ç†**
   - è‡ªåŠ¨è¯»å– Kiro IDE çš„ Token æ–‡ä»¶
   - è‡ªåŠ¨æ£€æµ‹ Token è¿‡æœŸï¼ˆæå‰ 5 åˆ†é’Ÿï¼‰
   - è‡ªåŠ¨åˆ·æ–° Token
   - çº¿ç¨‹å®‰å…¨çš„å¹¶å‘è®¿é—®

2. **MCP åè®®æ”¯æŒ**
   - å®Œæ•´çš„ JSON-RPC 2.0 å®ç°
   - tools/list - åˆ—å‡ºå¯ç”¨å·¥å…·
   - tools/call - è°ƒç”¨ MCP å·¥å…·

3. **Web Search åŠŸèƒ½**
   - å•ä¸ªæœç´¢æŸ¥è¯¢
   - æ‰¹é‡å¹¶å‘æœç´¢ï¼ˆæœ€å¤š 10 ä¸ªå¹¶å‘ï¼‰
   - å®Œæ•´çš„æœç´¢ç»“æœè§£æ

4. **Chat åŠŸèƒ½**
   - æµå¼èŠå¤©ï¼ˆSSEï¼‰
   - éæµå¼èŠå¤©
   - æ”¯æŒæ¨¡å‹é€‰æ‹©
   - åŠ¨æ€æ¨¡å‹åˆ—è¡¨è·å–ï¼ˆå¸¦ç¼“å­˜ï¼‰
   - EventStream åè®®è§£æ

5. **HTTP API ä»£ç†æœåŠ¡å™¨**
   - OpenAI æ ¼å¼æ¥å£å…¼å®¹
   - Claude æ ¼å¼æ¥å£å…¼å®¹
   - Anthropic åŸç”Ÿæ ¼å¼æ¥å£å…¼å®¹
   - æµå¼å’Œéæµå¼å“åº”æ”¯æŒ
   - CORS æ”¯æŒ

6. **Web UI æ§åˆ¶å°**
   - Token ç®¡ç†ç•Œé¢
   - Chat èŠå¤©ç•Œé¢ï¼ˆæ”¯æŒæ¨¡å‹é€‰æ‹©ï¼‰
   - Web Search ç•Œé¢
   - MCP å·¥å…·è°ƒç”¨ç•Œé¢
   - å“åº”å¼è®¾è®¡ï¼ˆæ¡Œé¢å’Œç§»åŠ¨ç«¯ï¼‰

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
kiro-api-client-go/
â”œâ”€â”€ auth.go                 # Token ç®¡ç†æ¨¡å—
â”œâ”€â”€ chat.go                 # Chat åŠŸèƒ½æ¨¡å—
â”œâ”€â”€ mcp.go                  # MCP åè®®æ¨¡å—
â”œâ”€â”€ search.go               # Web Search æ¨¡å—
â”œâ”€â”€ types.go                # æ•°æ®ç±»å‹å®šä¹‰
â”œâ”€â”€ client.go               # ä¸»å®¢æˆ·ç«¯
â”œâ”€â”€ chat_test.go            # Chat æµ‹è¯•
â”œâ”€â”€ types_test.go           # ç±»å‹æµ‹è¯•
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ main.go            # HTTP æœåŠ¡å™¨
â”‚   â”œâ”€â”€ main_test.go       # æœåŠ¡å™¨æµ‹è¯•
â”‚   â””â”€â”€ static/
â”‚       â””â”€â”€ index.html     # Web UI
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ main.go            # CLI ç¤ºä¾‹
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ chat_example.go    # Chat ç¤ºä¾‹
â”‚   â”œâ”€â”€ mcp_example.go     # MCP ç¤ºä¾‹
â”‚   â”œâ”€â”€ search_example.go  # Search ç¤ºä¾‹
â”‚   â””â”€â”€ token_example.go   # Token ç¤ºä¾‹
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ USAGE.md               # ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ ALIGNMENT.md           # å¯¹é½æ–‡æ¡£
â”œâ”€â”€ DEMO.md                # æ¼”ç¤ºæ–‡æ¡£
â”œâ”€â”€ CHANGELOG.md           # å˜æ›´æ—¥å¿—
â”œâ”€â”€ PROJECT_SUMMARY.md     # é¡¹ç›®æ€»ç»“ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ go.mod                 # Go æ¨¡å—å®šä¹‰
â””â”€â”€ test_all.sh            # æµ‹è¯•è„šæœ¬
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
go get github.com/jinfeijie/kiro-api-client-go
```

### åŸºæœ¬ä½¿ç”¨

```go
package main

import (
    "fmt"
    kiroclient "github.com/jinfeijie/kiro-api-client-go"
)

func main() {
    // åˆ›å»ºå®¢æˆ·ç«¯
    client := kiroclient.NewKiroClient()
    
    // è·å– Token
    token, err := client.Auth.GetAccessToken()
    if err != nil {
        panic(err)
    }
    
    fmt.Println("Token:", token)
}
```

### å¯åŠ¨ HTTP æœåŠ¡å™¨

```bash
cd server
go run main.go
```

è®¿é—® http://localhost:8080 æŸ¥çœ‹ Web UIã€‚

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### å•å…ƒæµ‹è¯•

```bash
$ go test -v ./...
```

**ç»“æœ**: 17/17 æµ‹è¯•é€šè¿‡

**æµ‹è¯•è¦†ç›–**:
- âœ… Token ç®¡ç†æµ‹è¯•
- âœ… Chat åŠŸèƒ½æµ‹è¯•ï¼ˆæœ‰æ•ˆæ¨¡å‹ã€æ— æ•ˆæ¨¡å‹ã€ä¸æŒ‡å®šæ¨¡å‹ï¼‰
- âœ… æ¨¡å‹éªŒè¯æµ‹è¯•
- âœ… HTTP API æµ‹è¯•ï¼ˆOpenAI æ ¼å¼ã€Claude æ ¼å¼ï¼‰
- âœ… æ¨¡å‹åˆ—è¡¨æµ‹è¯•
- âœ… æ— æ•ˆæ¨¡å‹è¿”å›è´¦å·å¯ç”¨æ¨¡å‹æµ‹è¯•

### é›†æˆæµ‹è¯•

æ‰€æœ‰ HTTP API ç«¯ç‚¹éƒ½ç»è¿‡æµ‹è¯•ï¼š
- âœ… `GET /api/token/status` - Token çŠ¶æ€æŸ¥è¯¢
- âœ… `POST /api/token/config` - Token é…ç½®
- âœ… `GET /api/models` - æ¨¡å‹åˆ—è¡¨
- âœ… `POST /api/chat` - Chat æ¥å£
- âœ… `POST /api/search` - æœç´¢æ¥å£
- âœ… `GET /api/tools` - MCP å·¥å…·åˆ—è¡¨
- âœ… `POST /api/tools/call` - MCP å·¥å…·è°ƒç”¨
- âœ… `POST /v1/chat/completions` - OpenAI æ ¼å¼
- âœ… `POST /v1/messages` - Claude æ ¼å¼
- âœ… `POST /anthropic/v1/messages` - Anthropic æ ¼å¼

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. Token ç®¡ç†

**è‡ªåŠ¨åŒ–æµç¨‹**:
```
è¯»å– Token â†’ æ£€æŸ¥è¿‡æœŸ â†’ è‡ªåŠ¨åˆ·æ–° â†’ è¿”å›æœ‰æ•ˆ Token
```

**å…³é”®ç‰¹æ€§**:
- æå‰ 5 åˆ†é’Ÿæ£€æµ‹è¿‡æœŸ
- çº¿ç¨‹å®‰å…¨ï¼ˆä½¿ç”¨ sync.RWMutexï¼‰
- è‡ªåŠ¨ä¿å­˜åˆ·æ–°åçš„ Token

### 2. åŠ¨æ€æ¨¡å‹åˆ—è¡¨

**å·¥ä½œæµç¨‹**:
```
æ£€æŸ¥ç¼“å­˜ â†’ ç¼“å­˜æœ‰æ•ˆï¼Ÿâ†’ è¿”å›ç¼“å­˜
                  â†“ å¦
            è°ƒç”¨ API â†’ æˆåŠŸï¼Ÿâ†’ æ›´æ–°ç¼“å­˜ â†’ è¿”å›æ¨¡å‹
                         â†“ å¦
                    è¿”å›é¢„å®šä¹‰åˆ—è¡¨
```

**å…³é”®ç‰¹æ€§**:
- 1 å°æ—¶ç¼“å­˜ TTL
- API å¤±è´¥æ—¶è‡ªåŠ¨é™çº§
- ç¡®ä¿è¿”å›å€¼æ°¸è¿œä¸ä¸º nil

### 3. Chat åŠŸèƒ½

**æ”¯æŒçš„æ¨¡å‹**:
- auto - è‡ªåŠ¨é€‰æ‹©
- claude-sonnet-4.5 - æœ€æ–° Sonnetï¼ˆæ¨èï¼‰
- claude-sonnet-4 - Sonnet 4
- claude-haiku-4.5 - æœ€æ–° Haiku
- claude-opus-4.5 - Opus 4.5

**æµå¼å“åº”**:
```go
client.Chat.ChatStreamWithModel(messages, "claude-sonnet-4.5", func(content string, done bool) {
    if done {
        fmt.Println("\nå®Œæˆ")
        return
    }
    fmt.Print(content)
})
```

### 4. HTTP API ä»£ç†

**ä¸‰ç§æ ¼å¼æ”¯æŒ**:

1. **OpenAI æ ¼å¼**:
```bash
curl -X POST http://localhost:8080/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "claude-sonnet-4.5",
    "messages": [{"role": "user", "content": "Hello"}],
    "stream": false
  }'
```

2. **Claude æ ¼å¼**:
```bash
curl -X POST http://localhost:8080/v1/messages \
  -H "Content-Type: application/json" \
  -d '{
    "model": "claude-sonnet-4.5",
    "messages": [{"role": "user", "content": "Hello"}],
    "max_tokens": 1000
  }'
```

3. **Anthropic æ ¼å¼**:
```bash
curl -X POST http://localhost:8080/anthropic/v1/messages \
  -H "Content-Type: application/json" \
  -d '{
    "model": "claude-sonnet-4.5",
    "messages": [{"role": "user", "content": "Hello"}]
  }'
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### API å“åº”æ—¶é—´

| æ¥å£ | å¹³å‡å“åº”æ—¶é—´ | å¤‡æ³¨ |
|------|-------------|------|
| Token çŠ¶æ€æŸ¥è¯¢ | < 10ms | æœ¬åœ°æ–‡ä»¶è¯»å– |
| æ¨¡å‹åˆ—è¡¨ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰ | < 1ms | å†…å­˜ç¼“å­˜ |
| æ¨¡å‹åˆ—è¡¨ï¼ˆç¼“å­˜æœªå‘½ä¸­ï¼‰ | < 500ms | API è°ƒç”¨ |
| Chatï¼ˆæµå¼ï¼‰ | é¦–å­—èŠ‚ < 1s | å–å†³äºç½‘ç»œ |
| Chatï¼ˆéæµå¼ï¼‰ | < 5s | å–å†³äºå“åº”é•¿åº¦ |
| Web Search | < 2s | å–å†³äºæŸ¥è¯¢å¤æ‚åº¦ |

### å¹¶å‘æ€§èƒ½

- Token ç®¡ç†ï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ”¯æŒé«˜å¹¶å‘
- æ¨¡å‹åˆ—è¡¨ç¼“å­˜ï¼šè¯»å†™é”ä¼˜åŒ–ï¼Œè¯»æ“ä½œæ— é˜»å¡
- HTTP æœåŠ¡å™¨ï¼šåŸºäº Ginï¼Œæ”¯æŒé«˜å¹¶å‘è¯·æ±‚

---

## ğŸ”’ å®‰å…¨æ€§

### Token å®‰å…¨

- Token æ–‡ä»¶æƒé™ï¼š0600ï¼ˆä»…æ‰€æœ‰è€…å¯è¯»å†™ï¼‰
- å†…å­˜ä¸­çš„ Tokenï¼šä½¿ç”¨ RWMutex ä¿æŠ¤
- HTTP ä¼ è¾“ï¼šæ”¯æŒ HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ï¼‰

### API å®‰å…¨

- è¾“å…¥éªŒè¯ï¼šæ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯
- é”™è¯¯å¤„ç†ï¼šä¸æš´éœ²æ•æ„Ÿä¿¡æ¯
- CORS é…ç½®ï¼šå¯æ ¹æ®éœ€æ±‚è°ƒæ•´

---

## ğŸ“š æ–‡æ¡£å®Œæ•´æ€§

### å·²å®Œæˆçš„æ–‡æ¡£

1. âœ… **README.md** - é¡¹ç›®ä»‹ç»å’Œå¿«é€Ÿå¼€å§‹
2. âœ… **USAGE.md** - è¯¦ç»†ä½¿ç”¨æŒ‡å—
3. âœ… **ALIGNMENT.md** - ä¸ Kiro IDE çš„å¯¹é½è¯´æ˜
4. âœ… **DEMO.md** - å®Œæ•´çš„æ¼”ç¤ºç¤ºä¾‹
5. âœ… **CHANGELOG.md** - å˜æ›´æ—¥å¿—
6. âœ… **PROJECT_SUMMARY.md** - é¡¹ç›®æ€»ç»“ï¼ˆæœ¬æ–‡ä»¶ï¼‰

### ä»£ç æ³¨é‡Š

- æ‰€æœ‰å…¬å¼€å‡½æ•°éƒ½æœ‰ä¸­æ–‡æ³¨é‡Š
- å…³é”®é€»è¾‘éƒ½æœ‰è¯¦ç»†è¯´æ˜
- å¤æ‚ç®—æ³•éƒ½æœ‰æ³¨é‡Šè§£é‡Š

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. Token ç®¡ç†

```go
// âœ… æ¨èï¼šä½¿ç”¨ GetAccessTokenï¼Œè‡ªåŠ¨å¤„ç†åˆ·æ–°
token, err := client.Auth.GetAccessToken()

// âŒ ä¸æ¨èï¼šç›´æ¥è¯»å– Tokenï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†è¿‡æœŸ
token, err := client.Auth.ReadToken()
```

### 2. æ¨¡å‹é€‰æ‹©

```go
// âœ… æ¨èï¼šä½¿ç”¨å…·ä½“æ¨¡å‹
client.Chat.ChatStreamWithModel(messages, "claude-sonnet-4.5", callback)

// âœ… ä¹Ÿå¯ä»¥ï¼šä½¿ç”¨ auto è®©ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©
client.Chat.ChatStreamWithModel(messages, "auto", callback)

// âœ… ä¹Ÿå¯ä»¥ï¼šä¸æŒ‡å®šæ¨¡å‹ï¼ˆä½¿ç”¨é»˜è®¤ï¼‰
client.Chat.ChatStream(messages, callback)
```

### 3. é”™è¯¯å¤„ç†

```go
// âœ… æ¨èï¼šå®Œæ•´çš„é”™è¯¯å¤„ç†
token, err := client.Auth.GetAccessToken()
if err != nil {
    log.Printf("è·å– Token å¤±è´¥: %v", err)
    return err
}

// âŒ ä¸æ¨èï¼šå¿½ç•¥é”™è¯¯
token, _ := client.Auth.GetAccessToken()
```

---

## ğŸ”® æœªæ¥ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2 å‘¨ï¼‰

1. **æ€§èƒ½ä¼˜åŒ–**
   - æ·»åŠ è¿æ¥æ± ç®¡ç†
   - ä¼˜åŒ– HTTP å®¢æˆ·ç«¯é…ç½®
   - æ·»åŠ è¯·æ±‚é‡è¯•æœºåˆ¶

2. **åŠŸèƒ½å¢å¼º**
   - æ·»åŠ æ¨¡å‹èƒ½åŠ›æŸ¥è¯¢æ¥å£
   - æ·»åŠ æ¨¡å‹ä½¿ç”¨ç»Ÿè®¡æ¥å£
   - æ·»åŠ æ‰‹åŠ¨åˆ·æ–°ç¼“å­˜æ¥å£

3. **æµ‹è¯•å¢å¼º**
   - æ·»åŠ æ€§èƒ½æµ‹è¯•
   - æ·»åŠ å‹åŠ›æµ‹è¯•
   - æ·»åŠ ç«¯åˆ°ç«¯æµ‹è¯•

### ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2 æœˆï¼‰

1. **ç›‘æ§å’Œæ—¥å¿—**
   - é›†æˆ Prometheus æŒ‡æ ‡
   - æ·»åŠ ç»“æ„åŒ–æ—¥å¿—
   - æ·»åŠ åˆ†å¸ƒå¼è¿½è¸ª

2. **éƒ¨ç½²ä¼˜åŒ–**
   - Docker é•œåƒ
   - Kubernetes éƒ¨ç½²é…ç½®
   - CI/CD æµç¨‹

3. **æ–‡æ¡£å¢å¼º**
   - API æ–‡æ¡£ï¼ˆSwagger/OpenAPIï¼‰
   - æ¶æ„è®¾è®¡æ–‡æ¡£
   - æ•…éšœæ’æŸ¥æŒ‡å—

### é•¿æœŸä¼˜åŒ–ï¼ˆ3-6 æœˆï¼‰

1. **å¤šè¯­è¨€æ”¯æŒ**
   - Python SDK
   - JavaScript/TypeScript SDK
   - Rust SDK

2. **é«˜çº§åŠŸèƒ½**
   - æµé‡æ§åˆ¶å’Œé™æµ
   - æ™ºèƒ½è·¯ç”±å’Œè´Ÿè½½å‡è¡¡
   - å¤šåŒºåŸŸæ”¯æŒ

3. **ç”Ÿæ€ç³»ç»Ÿ**
   - æ’ä»¶ç³»ç»Ÿ
   - ç¤¾åŒºè´¡çŒ®æŒ‡å—
   - ç¤ºä¾‹é¡¹ç›®åº“

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ä»£ç é£æ ¼

- éµå¾ª Go å®˜æ–¹ä»£ç è§„èŒƒ
- ä½¿ç”¨ `gofmt` æ ¼å¼åŒ–ä»£ç 
- ä½¿ç”¨ `golint` æ£€æŸ¥ä»£ç è´¨é‡
- å…³é”®é€»è¾‘å¿…é¡»æœ‰ä¸­æ–‡æ³¨é‡Š

### æäº¤è§„èŒƒ

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type**:
- feat: æ–°åŠŸèƒ½
- fix: ä¿®å¤ bug
- docs: æ–‡æ¡£æ›´æ–°
- style: ä»£ç æ ¼å¼è°ƒæ•´
- refactor: é‡æ„
- test: æµ‹è¯•ç›¸å…³
- chore: æ„å»º/å·¥å…·ç›¸å…³

### æµ‹è¯•è¦æ±‚

- æ‰€æœ‰æ–°åŠŸèƒ½å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- æµ‹è¯•è¦†ç›–ç‡ä¸ä½äº 80%
- æ‰€æœ‰æµ‹è¯•å¿…é¡»é€šè¿‡

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®åœ°å€**: https://github.com/jinfeijie/kiro-api-client-go
- **é—®é¢˜åé¦ˆ**: GitHub Issues
- **é‚®ç®±**: jinfeijie@example.com

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ Kiro IDE å›¢é˜Ÿæä¾›çš„ä¼˜ç§€å¼€å‘å·¥å…·å’Œ API æ”¯æŒã€‚

---

**æœ€åæ›´æ–°**: 2024-02-04  
**ç‰ˆæœ¬**: v1.0.0  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
